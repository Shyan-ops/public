(this["webpackJsonpforge-react"]=this["webpackJsonpforge-react"]||[]).push([[0],{260:function(e,t,n){},285:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n(0),o=n(13),i=n.n(o),c=n(9),s=(n(260),n(243)),l=n(28),p=Object(s.a)({palette:{background:{dark:"#F4F6F8",default:l.a.common.white,paper:l.a.common.white},primary:{main:l.a.indigo[500]},secondary:{main:l.a.indigo[500]},text:{primary:l.a.blueGrey[900],secondary:l.a.blueGrey[600]}},shadows:["none","0 0 0 1px rgba(63,63,68,0.05), 0 1px 2px 0 rgba(63,63,68,0.15)","0 0 1px 0 rgba(0,0,0,0.31), 0 2px 2px -2px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 3px 4px -2px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 3px 4px -2px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 4px 6px -2px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 4px 6px -2px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 4px 8px -2px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 5px 8px -2px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 6px 12px -4px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 7px 12px -4px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 6px 16px -4px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 7px 16px -4px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 8px 18px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 9px 18px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 10px 20px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 11px 20px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 12px 22px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 13px 22px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 14px 24px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 16px 28px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 18px 30px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 20px 32px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 22px 34px -8px rgba(0,0,0,0.25)","0 0 1px 0 rgba(0,0,0,0.31), 0 24px 36px -8px rgba(0,0,0,0.25)"],typography:{h1:{fontWeight:500,fontSize:35,letterSpacing:"-0.24px"},h2:{fontWeight:500,fontSize:29,letterSpacing:"-0.24px"},h3:{fontWeight:500,fontSize:24,letterSpacing:"-0.06px"},h4:{fontWeight:500,fontSize:20,letterSpacing:"-0.06px"},h5:{fontWeight:500,fontSize:16,letterSpacing:"-0.05px"},h6:{fontWeight:500,fontSize:14,letterSpacing:"-0.05px"},overline:{fontWeight:500}}}),u=n(77),d=n(331),x=Object(u.a)((function(){return Object(d.a)({"@global":{"*":{boxSizing:"border-box",margin:0,padding:0},html:{"-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",height:"100%",width:"100%"},body:{backgroundColor:"#f4f6f8",height:"100%",width:"100%"},a:{textDecoration:"none"},"#root":{height:"100%",width:"100%"}}})})),b=function(){return x(),null},h=n(326),g=n(327),j=n(328),f=n(129),m=Object(r.createContext)(null),O=Object(r.createContext)(null),v=n(66),w=n(301);function y(){return Math.round(20*Math.random())-10}function k(){var e=50+y(),t=50+y();return{top:"".concat(e,"%"),left:"".concat(t,"%"),transform:"translate(-".concat(e,"%, -").concat(t,"%)")}}var C=Object(u.a)((function(e){return{paper:{overflow:"scroll",position:"absolute",width:"50vw",height:"90vh",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[4],padding:e.spacing(3),"& .MuiTextField-root":{margin:e.spacing(2),width:"25ch"}}}})),S=[{id:"",itemName:"",externalId:"",properties:""}];function I(e){e.data;var t=C(),n=Object(r.useState)(null),o=Object(c.a)(n,2),i=o[0],s=o[1],l=Object(r.useState)(k),p=Object(c.a)(l,1)[0],u=Object(r.useState)(!1),d=Object(c.a)(u,2),x=d[0],b=d[1],h=Object(r.useContext)(O),g=h.quantity,j=(h.setQuantity,[]),m=[{field:"id",headerName:"dbId",width:90},{field:"externalId",headerName:"External ID",width:200},{field:"itemName",headerName:"Name",width:250},{field:"properties",headerName:"Properties",width:189,renderCell:function(e){return Object(a.jsx)(v.a,{variant:"contained",size:"small",style:{marginLeft:16},onClick:function(){b(!0),s(e.value)},children:"View"})}}];g&&g.map((function(e){var t={id:e.dbId,externalId:e.externalId,itemName:e.name,properties:e.properties};j.push(t)}));var y=Object(a.jsxs)("div",{style:p,className:t.paper,children:[Object(a.jsx)("h2",{id:"simple-modal-title",children:"Properties"}),Object(a.jsx)("pre",{children:JSON.stringify(i,null,2)})]});return Object(a.jsxs)("div",{children:[g?Object(a.jsx)("div",{style:{height:"80vh",width:"100%"},children:Object(a.jsx)(f.a,{rows:j,columns:m,autoPageSize:!0,checkboxSelection:!1,showCellRightBorder:!0,showColumnRightBorder:!0})}):Object(a.jsx)("div",{style:{height:"80vh",width:"100%"},children:Object(a.jsx)(f.a,{rows:S,columns:m,autoPageSize:!0,checkboxSelection:!1,showCellRightBorder:!0,showColumnRightBorder:!0})}),Object(a.jsx)(w.a,{open:x,onClose:function(){b(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",children:y})]})}var E=n(132),N=n(329),T=n(247),V=function(){var e=Object(r.useState)(null),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(r.useContext)(O),s=i.quantity;i.setQuantity;return Object(r.useEffect)((function(){var e=[];s.map((function(t){t.properties.map((function(t){-1!==e.indexOf(t.displayName)||e.push(t.displayName)}))})),console.log(e),o(e)}),[s]),Object(a.jsx)("div",{children:n?Object(a.jsx)(N.a,{id:"combo-box-demo",options:n,multiple:!0,renderInput:function(e){return Object(a.jsx)(T.a,Object(E.a)(Object(E.a)({},e),{},{label:"Category",variant:"outlined"}))}}):null})},A=function(){return Object(a.jsx)("div",{children:Object(a.jsx)("form",{noValidate:!0,autoComplete:"off",children:Object(a.jsx)(T.a,{id:"search-text",label:"Search within the selected category",variant:"outlined",fullWidth:!0})})})},z=function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(V,{}),Object(a.jsx)(A,{}),Object(a.jsx)(I,{})]})},B=n(64),P=n.n(B),W=n(100),M=n(76),R=n.n(M),D=function(){var e=Object(W.a)(P.a.mark((function e(t){var n,a,r,o;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.get("https://wsp-internal-forge.herokuapp.com/api/forge/oauth/token");case 2:n=e.sent,a={accessToken:n.data.access_token,env:"MD20ProdUS",api:"D3S"},r=document.getElementById("quantityViewerContainer"),o=new Autodesk.Viewing.Private.GuiViewer3D(r,{extensions:["QuantityExtension"]}),Autodesk.Viewing.Initializer(a,(function(){o.start(),Autodesk.Viewing.Document.load("urn:".concat(t),(function(e){var t=e.getRoot().getDefaultGeometry();o.loadDocumentNode(e,t)}))}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(r.useContext)(O),t=(e.quantity,e.setQuantity);function n(e,t){Autodesk.Viewing.Extension.call(this,e,t)}return n.prototype=Object.create(Autodesk.Viewing.Extension.prototype),n.prototype.constructor=n,n.prototype.load=function(){return!0},n.prototype.onToolbarCreated=function(e){var n=this.viewer,a=new Autodesk.Viewing.UI.Button("quantityExtensionIcon");a.onClick=function(){var e;e=function(e){n.model.getBulkProperties(e,null,(function(e){t(e)}))},n.getObjectTree((function(t){var n=[];t.enumNodeChildren(t.getRootId(),(function(e){0===t.getChildCount(e)&&n.push(e)}),!0),e(n)}))},a.addClass("modelSummaryExtensionIcon"),a.setToolTip("Quantity Take-off");var r=new Autodesk.Viewing.UI.Button("clashExtensionIcon");r.onClick=function(){console.log("Clash detection clicked!!")},r.addClass("clashExtensionIcon"),r.setToolTip("Clash Analysis"),this.subToolbar=new Autodesk.Viewing.UI.ControlGroup("my-custom-toolbar"),this.subToolbar.addControl(a),this.subToolbar.addControl(r),e.addControl(this.subToolbar)},n.prototype.unload=function(){return this.subToolbar&&(this.viewer.toolbar.removeControl(this.subToolbar),this.subToolbar=null),!0},Autodesk.Viewing.theExtensionManager.registerExtension("QuantityExtension",n),null},q=function(){var e=Object(r.useContext)(m),t=e.urn;e.setUrn;return Object(r.useEffect)((function(){if(t){var e=window.NOP_VIEWER;e?(e.finish(),e=null,Autodesk.Viewing.shutdown(),D(t)):D(t)}else console.log("no urn!")}),[t]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{id:"quantityViewerContainer"}),Object(a.jsx)(G,{})]})},Q=n(325),U=n(241),F=n.n(U),J=n(242),_=n.n(J),L=n(324),H=n(136),K=n(252),X=n(240),Y=n.n(X),Z=n(239),$=n.n(Z),ee=Object(u.a)((function(e){return{root:{height:"90vh",flexGrow:1},typography:{padding:10,backgroundColor:"#f5f5f5"},tree:{height:"82vh",padding:e.spacing(1,3,3,3),flexGrow:1}}})),te=function(){var e=ee(),t=Object(r.useState)([]),n=Object(c.a)(t,2),o=n[0],i=n[1],s=Object(r.useContext)(m),l=(s.urn,s.setUrn);Object(r.useEffect)((function(){(function(){var e=Object(W.a)(P.a.mark((function e(){var t,n,a,r,o;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,R.a.get("https://wsp-internal-forge.herokuapp.com/api/forge/oss/bucketTree");case 3:n=e.sent,a=0;case 5:if(!(a<n.data.length)){e.next=14;break}return e.next=8,R.a.get("https://wsp-internal-forge.herokuapp.com/api/forge/oss/bucketTree/?id=".concat(n.data[a].id));case 8:r=e.sent,o={id:n.data[a].id,text:n.data[a].text,children:r.data},t.push(o);case 11:a++,e.next=5;break;case 14:console.log(t),i(t);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var p=function e(t){return Object(a.jsx)(L.a,{nodeId:t.id,label:t.text,icon:(n=t.children,n?Object(a.jsx)($.a,{}):Object(a.jsx)(Y.a,{})),onClick:function(){t.children||l(t.id)},children:Array.isArray(t.children)?t.children.map((function(t){return e(t)})):null},t.id);var n};return Object(a.jsx)("div",{className:e.root,children:Object(a.jsxs)(H.a,{className:e.paperRoot,variant:"outlined",style:{overflow:"auto"},width:"1",children:[Object(a.jsx)(K.a,{className:e.typography,variant:"h5",gutterBottom:!0,align:"center",children:"BIM Models"}),Object(a.jsx)(Q.a,{className:e.tree,defaultCollapseIcon:Object(a.jsx)(F.a,{}),defaultExpanded:["root"],defaultExpandIcon:Object(a.jsx)(_.a,{}),children:o.map((function(e){return p(e)}))})]})})},ne=Object(u.a)((function(e){return{root:{display:"flex"},content:{flexGrow:1,padding:e.spacing(1)}}}));var ae=function(){var e=ne(),t=Object(r.useState)(null),n=Object(c.a)(t,2),o=n[0],i=n[1],s=Object(r.useState)(null),l=Object(c.a)(s,2),u=l[0],d=l[1],x=Object(r.useMemo)((function(){return{urn:o,setUrn:i}}),[o,i]),f=Object(r.useMemo)((function(){return{quantity:u,setQuantity:d}}),[u,d]);Object(r.useEffect)((function(){console.log(u)}),[u]);var v=Object(r.useRef)();return Object(r.useEffect)((function(){u&&v.current.scrollIntoView({behavior:"smooth",block:"start"})}),[u]),Object(a.jsx)(m.Provider,{value:x,children:Object(a.jsxs)(h.a,{theme:p,children:[Object(a.jsx)(b,{}),Object(a.jsx)("div",{className:e.root,children:Object(a.jsx)("div",{className:e.content,children:Object(a.jsx)(g.a,{maxWidth:!1,children:Object(a.jsxs)(j.a,{container:!0,spacing:2,children:[Object(a.jsx)(j.a,{item:!0,lg:3,sm:12,children:Object(a.jsx)(te,{})}),Object(a.jsxs)(O.Provider,{value:f,children:[Object(a.jsx)(j.a,{item:!0,lg:9,sm:12,children:Object(a.jsx)(q,{})}),u?Object(a.jsx)(j.a,{item:!0,lg:6,sm:12,ref:v,children:Object(a.jsx)(z,{})}):null]})]})})})})]})})};i.a.render(Object(a.jsx)(ae,{}),document.getElementById("root"))}},[[285,1,2]]]);
//# sourceMappingURL=main.06914d60.chunk.js.map